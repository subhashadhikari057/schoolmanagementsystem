## ğŸ§­ **System Overview (Project Vision)**

Design and develop a **single-institution School Management System (SMS)** that empowers seamless operations for educational institutions by providing a **modular**, **secure**, and **scalable** platform. It serves diverse user rolesâ€”**students**, **parents**, **teachers**, **administrators**, and **super admins**â€”with clear boundaries of access and responsibility.

### ğŸ¯ Core Goals

- **Modular architecture** enabling scalable and isolated development per domain (e.g., academics, attendance, finance).
- **Atomic Design (Atoms â†’ Molecules â†’ Organisms â†’ Templates)** for frontend components.
- **Domain-Driven Design (DDD)** principles applied in backend service structuring.
- **Role-Based Access Control (RBAC)** and strict permission enforcement.
- Adherence to **modern security best practices**, performance optimizations, and clean developer onboarding.

---

## ğŸ—ï¸ **Architecture Style: Modular Monolith + DDD**

### âœ… Why Modular Monolith?

A **modular monolith** is ideal for this LMS because:

- You're targeting a **single school** environment, not a multi-tenant SaaS.
- You need to support **multiple interrelated domains** (e.g., user management, exam grading, complaints).
- You want strong **developer productivity** without the complexity of microservices.
- The system will be containerized and scalable as a single artifact, simplifying deployment and orchestration.

| Layer              | Detail                                                                                                                           |
| ------------------ | -------------------------------------------------------------------------------------------------------------------------------- |
| **Frontend**       | Atomic Design hierarchy to maintain UI consistency and reusability                                                               |
| **Backend**        | Modular Monolith using **DDD** â€“ each domain (Auth, Academics, Attendance, Finance, etc.) is isolated in its own bounded context |
| **Infrastructure** | Containerized backend (Docker), exposed via a secure REST API, with PostgreSQL as the primary datastore                          |
| **Security**       | JWT Auth + Role Context + Permission-based Filtering                                                                             |
| **Deployment**     | Monolith Docker image, CI/CD via GitHub Actions, with long-term cloud readiness                                                  |

---

## ğŸ” **Authentication & Authorization Design**

### ğŸ”’ Authentication (Session Security)

| Feature                  | Design                                                                 |
| ------------------------ | ---------------------------------------------------------------------- |
| **Access Token**         | JWT (short-lived, stateless)                                           |
| **Refresh Token**        | Stored in `httpOnly` cookie for renewal                                |
| **Mobile Token Binding** | (Optional) Device-bound tokens to prevent reuse across devices         |
| **Password Hashing**     | bcrypt with salt & pepper                                              |
| **Brute Force Defense**  | Rate-limiting and lockouts via middleware (e.g., Redis-backed limiter) |

### ğŸ”‘ Authorization (RBAC with Contextual Enforcement)

Roles are structured to limit and control access to data **by role and context**. This includes teacher-class assignments, parent-child relationships, and administrative domain responsibilities.

| Role                         | Sample Scope                                                   |
| ---------------------------- | -------------------------------------------------------------- |
| **Super Admin**              | Full control of all system modules                             |
| **Admin**                    | Access to assigned modules (attendance, fees, academics, etc.) |
| **Teacher**                  | Assigned classes/subjects only                                 |
| **Student**                  | Own data only                                                  |
| **Parent**                   | Data of their linked children only                             |
| **Finance Staff (sub-role)** | Access to payment modules but not exam results                 |

All access rules are enforced via:

- **Route guards** (based on JWT + claims)
- **Service-layer guards** (e.g., is this student assigned to this parent?)
- **Database-level scoping** (e.g., only show student records where `parent_id` matches)

---

## ğŸ“Š **Role & Permissions Matrix**

| Feature               | SuperAdmin | Admin | Teacher               | Parent            | Student |
| --------------------- | ---------- | ----- | --------------------- | ----------------- | ------- |
| View/Manage Students  | âœ…         | âœ…    | ğŸ”¶ (own class)        | ğŸ”¶ (own children) | âŒ      |
| Submit/Approve Leaves | âŒ         | âœ…    | âœ…                    | âœ…                | âœ…      |
| Mark/View Attendance  | âŒ         | âœ…    | âœ…                    | ğŸ”¶                | ğŸ”¶      |
| Enter Exam Results    | âŒ         | âœ…    | âœ… (assigned class)   | âŒ                | âŒ      |
| View Assignments      | âŒ         | âœ…    | âœ…                    | âœ…                | âœ…      |
| File Complaints       | âŒ         | âŒ    | âŒ                    | âœ…                | âœ…      |
| Resolve Complaints    | âœ…         | âœ…    | ğŸ”¶ (if class teacher) | âŒ                | âŒ      |
| View Fee Payments     | âœ…         | âœ…    | âŒ                    | âœ…                | âŒ      |
| Manage Users          | âœ…         | âœ…    | âŒ                    | âŒ                | âŒ      |

> ğŸ”¶ = Contextual (e.g., based on class, child, or subject assignment)

These permissions will be centrally defined in:

- `roles-permissions.config.ts`
- Enforced via middleware (`withRoleGuard`, `hasPermission`)
- Sourced dynamically from DB for future flexibility

---

## ğŸ—ºï¸ **Key Architectural Diagrams**

1. ### ğŸ“¦ Component Diagram
   - Visual breakdown of modules like:
     - `AuthModule`
     - `StudentModule`
     - `TeacherModule`
     - `ExamModule`
     - `ComplaintModule`
     - `FeeModule`
   - Shows interface boundaries and external integrations (e.g., file upload, email service)

2. ### ğŸ” Data Flow Diagram
   - Example: _Student submits assignment â†’ validated â†’ stored â†’ teacher notified â†’ feedback loop_
   - Tracks request lifecycle across frontend â†’ backend â†’ DB â†’ response/UI feedback

3. ### ğŸ”„ Sequence Diagrams

   #### a. Parent logs in and switches between children

   #### b. Teacher marks attendance and submits to backend

   #### c. Admin posts results â†’ student views report card

---

## âœ… Optional Enhancements (Implemented)

| Feature                  | Purpose                                                                                                                 |
| ------------------------ | ----------------------------------------------------------------------------------------------------------------------- |
| **Granular Permissions** | Role sub-types like â€œExam Adminâ€, â€œFee Clerkâ€ with limited views/actions                                                |
| **Mobile Token Binding** | Enhance session security in mobile apps                                                                                 |
| **Audit Trails**         | Track sensitive operations (fee edits, result updates, role changes) in `audit_logs` table with actor/timestamp details |

---

## âš ï¸ Common Assumptions (Debunked)

| Assumption                          | Risk                                                                                                            |
| ----------------------------------- | --------------------------------------------------------------------------------------------------------------- |
| "Parents only have one child"       | âŒ Multi-child switching already supported â€“ queries must join via junction table                               |
| "Teachers donâ€™t overlap subjects"   | âŒ Teachers may have many-to-many relations with classes and subjects                                           |
| "JWT is enough"                     | âŒ Implement refresh token rotation, CSRF protection on sensitive endpoints, and session invalidation on logout |
| "Modular monoliths are always easy" | âš ï¸ Without strict module boundaries, can become unmaintainable â€“ isolate `domain services` carefully            |

---

## ğŸ§  Final Notes

This document captures **only the foundation**. To ensure long-term project success:

- Treat **each module as a mini-service** with its own:
  - Routes
  - Interfaces
  - Logic
- Never bypass **domain boundaries** or duplicate logic.
- Maintain strict separation of **concerns and responsibilities** (especially for frontend state and backend services).
